document.attachEvent&&alert("这个例子不支持 Old IE 哦"),define("lucky/dist/main",["./data","./lucky","jquery","easing","./user"],function(t){var i=t("./data"),e=t("./lucky");e.init(i)}),define("lucky/dist/data",[],["马云","马化腾","李彦宏","周鸿祎","玉伯","沉鱼","丹侠","贯高","邵帅","陆辉","南伯","崔护","偏右","远尘","臻儿","左宜","张初尘","初成","琼羽","异草","闭月","周爱民","陈皓","winter","army","hax","老赵","sofish","罗龙浩"]),define("lucky/dist/lucky",["jquery","easing","./user"],function(t,i,e){function s(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))}function h(t,i){return s(t,i)<=(t.width+i.width)/2}function o(t,i){var e=i.y-t.y,h=i.x-t.x,o=s(t,i),n=Math.ceil(((t.width+i.width)/2-o)/u),r=e>0?Math.ceil(n*e/o):Math.floor(n*e/o),a=h>0?Math.ceil(n*h/o):Math.floor(n*h/o);t.lucky?(i._xMove+=2*a,i._yMove+=2*r):i.lucky?(t._xMove+=-2*a,t._yMove+=-2*r):(t._yMove+=-1*r,i._yMove+=r,t._xMove+=-1*a,i._xMove+=a)}var n=t("jquery");t("easing");var r=t("./user"),a=100,u=4;e.exports={users:[],init:function(t){n("#container").css("background","none"),this.data=t,this.users=t.map(function(i){return new r(i,t[i])}),this._bindUI()},_bindUI:function(){function t(){"start"===e.getAttribute("data-action")?(e.setAttribute("data-action","stop"),e.innerHTML=e.getAttribute("data-text-stop"),i.start()):(e.setAttribute("data-action","start"),e.innerHTML=e.getAttribute("data-text-start"),i.stop())}var i=this,e=document.querySelector("#go");e.innerHTML=e.getAttribute("data-text-start"),e.addEventListener("click",t,!1),n("#lucky-balls").on("click","li",function(t){var e=n(t.target),s=e.text();i.addItem(s),i.hit(),e.remove()}),n("#balls").on("click","li",function(t){for(var e=n(t.target),s=e.text(),h=0;i.users.length>h;h++){var o=i.users[h];if(o.name===s){i.moveLucky(),i.luckyUser!==o&&i.setLucky(o);break}}}),document.addEventListener("keydown",function(e){"32"==e.keyCode?t():"27"==e.keyCode&&(i.moveLucky(),n("#lucky-balls li").eq(0).click())},!1)},start:function(){this.timer&&clearTimeout(this.timer),this.moveLucky(),this.users.forEach(function(t){t.start()})},stop:function(){var t=this.users,i=0,e=t[0];t.forEach(function(t){t.stop(),t.zIndex>i&&(e=t,i=t.zIndex)}),e.bang(),this.hit(),this.luckyUser=e},removeItem:function(t){for(var i=0;this.users.length>i;i++){var e=this.users[i];e===t&&this.users.splice(i,1)}},addItem:function(t){this.users.push(new r(t))},moveLucky:function(){var t=this.luckyUser;t&&(t.el[0].style.cssText="",t.el.prependTo("#lucky-balls"),this.removeItem(t),this.luckyUser=null)},setLucky:function(t){this.users.forEach(function(t){t.stop()}),this.luckyUser=t,t.bang(),this.hit()},hit:function(){var t=this,i=0,e=this.users;e.forEach(function(t){t.beginHit()});for(var s=0;e.length>s;s++)for(var n=s+1;e.length>n;n++)h(e[s],e[n])&&(o(e[s],e[n]),i++);e.forEach(function(t){t.hitMove()}),i>0&&(this.timer=setTimeout(function(){t.hit()},a))}}}),define("lucky/dist/user",["jquery"],function(t,i,e){function s(t,i){this.name=t,this.options=i||{},this.el=null,this.width=0,this.height=0,this.left=0,this.top=0,this.x=0,this.y=0,this.moving=!1,this.lucky=!1,this.createEl(),this.move()}function h(t,i){return t=t||0,i=i||1,Math.floor(Math.random()*(i-t+1)+t)}var o=t("jquery"),n=500,r=900,a=60,u=60,l=200,c=200,f=100,y=100,d=500,p=500;e.exports=s,s.prototype.createEl=function(){this.el=o("<li>"+this.name+"</li>").appendTo("#balls"),this.width=this.el.width(),this.height=this.el.height()},s.prototype.move=function(t){this.left=h(0,r-this.width),this.top=h(0,n-this.height),this.zIndex=h(0,f),this.reflow(t)},s.prototype.reflow=function(t,i){this.x=this.left+this.width/2,this.y=this.top+this.height/2,this.el[0].style.zIndex=this.zIndex,i?(this.el[0].style.left=this.left,this.el[0].style.top=this.top):this.el.animate({left:this.left,top:this.top},h(y,d),"easeOutBack",t)},s.prototype.start=function(){this.reset(),this.moving=!0,this.autoMove()},s.prototype.reset=function(){this.el.stop(!0,!0),this.lucky=!1,this.el[0].className="",this.el[0].style.width=a+"px",this.el[0].style.height=u+"px",this.width=this.el.width(),this.height=this.el.height(),this._maxTop=n-this.height,this._maxLeft=r-this.width},s.prototype.autoMove=function(){var t=this;this.moving&&this.move(function(){t.autoMove()})},s.prototype.stop=function(){this.el.stop(!0,!0),this.moving=!1},s.prototype.bang=function(){this.lucky=!0,this.el[0].className="selected",this.width=l,this.height=c,this.left=(r-this.width)/2,this.top=(n-this.height)/2,this.el.animate({left:this.left,top:this.top,width:this.width,height:this.height},p)},s.prototype.beginHit=function(){this._xMove=0,this._yMove=0},s.prototype.hitMove=function(){this.left+=this._xMove,this.top+=this._yMove,this.top=0>this.top?0:this.top>this._maxTop?this._maxTop:this.top,this.left=0>this.left?0:this.left>this._maxLeft?this._maxLeft:this.left,this.reflow(null,!1)}});